<?xml version="1.0" encoding="UTF-8"?>
<cursor xmlns="http://bio4j.ru/biodef-repo/store"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://bio4j.ru/biodef-repo/store http://bio4j.ru/biodef-repo/store/store-v10.xsd"
        multiselection="false">
	<SQL action="select">
		<text><![CDATA[
select
  a.scheduleid, sp.screenplayid, si.cronperiod, sp.filename, sp.md5hash, t.aterminalkey, st.priority
from
  schedule a
    inner join schitem si on si.scheduleid = a.scheduleid and not si.isdeleted
    inner join screenplay sp on sp.screenplayid = si.screenplayid and not sp.isdeleted
    inner join schterm st on st.scheduleid = a.scheduleid
    inner join aterminal t on t.aterminalid = st.aterminalid
where not a.isdeleted and st.isactive
and t.aterminalkey = :aterminalkey
--and si.cronperiod like '%'||:querydate||'%'
        ]]></text>
        <param name="aterminalkey" type="string"/>
        <param name="querydate" type="string"/>
	</SQL>
 	<fields>
		<field name="screenplayid" type="integer" pk="true"/>
        <field name="cronperiod" type="string"/>
        <field name="filename" type="string"/>
        <field name="md5hash" type="string"/>
        <field name="priority" type="integer"/>
    </fields>
</cursor>

